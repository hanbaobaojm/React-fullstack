(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{364:function(e,t,a){},460:function(e,t,a){},467:function(e,t,a){},468:function(e,t,a){},483:function(e,t,a){},555:function(e,t,a){},568:function(e,t,a){},569:function(e,t,a){"use strict";a.r(t);var n,r=a(6),c=a(0),s=a.n(c),i=a(46),o=a.n(i),l=(a(363),a(108)),u=a(51),d=(a.p,a(109)),j=a(110),b=a(115),m=a(114),h=(a(364),a.p+"static/media/writing.9ee194df.png"),f=a(353),O=a(581),p=a(347),x=a(71),g=a(57),y=a.n(g),v=function(e){return y.a.get("/manage/category/list",{params:{parentId:e}})},C=function(e){return y.a.get("/manage/category/info",{params:{categoryId:e}})},k={user:{}},S="user_key",I={saveUser:function(e){localStorage.setItem(S,JSON.stringify(e))},getUser:function(){return JSON.parse(localStorage.getItem(S)||"{}")},removeUser:function(){localStorage.removeItem(S)}},w=function(e){Object(b.a)(a,e);var t=Object(m.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(j.a)(a,[{key:"render",value:function(){var e=this,t=k.user;if(t&&t._id)return Object(r.jsx)(u.a,{to:"/home"});return Object(r.jsxs)("div",{className:"login",children:[Object(r.jsxs)("div",{className:"loginHead",children:[Object(r.jsx)("img",{src:h,alt:h}),Object(r.jsx)("h1",{children:"Background management system"})]}),Object(r.jsxs)("section",{className:"loginBody",children:[Object(r.jsx)("h2",{children:"Login"}),Object(r.jsxs)(O.a,{name:"basic",onFinish:function(t){var a,n;(a=t.username,n=t.password,new Promise((function(e,t){y.a.post("/login",{username:a,password:n}).then((function(t){e(t.data)})).catch((function(e){f.b.error(e.message)}))}))).then((function(t){0===t.status?(f.b.success("Login Success!"),k.user=t.data,I.saveUser(t.data),e.props.history.replace("/")):f.b.error(t.msg)}))},onFinishFailed:function(e){console.log("Failed:",e)},children:[Object(r.jsx)(O.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}],children:Object(r.jsx)(p.a,{})}),Object(r.jsx)(O.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(r.jsx)(p.a.Password,{})}),Object(r.jsx)(O.a.Item,{children:Object(r.jsx)(x.a,{className:"btn1",type:"primary",htmlType:"submit",children:"Login"})})]})]})]})}}]),a}(s.a.Component),N=a(577),P=a(129),_=(a(460),a(594)),E=a(595),F=a(596),A=a(597),D=a(598),V=a(599),L=a(600),T=a(601),R=[{title:"Main",key:"/home",icon:Object(r.jsx)(_.a,{}),isPublic:!0},{title:"Product",key:"/products",icon:Object(r.jsx)(E.a,{}),children:[{title:"Category",key:"/category",icon:Object(r.jsx)(E.a,{})},{title:"Items",key:"/product",icon:Object(r.jsx)(E.a,{})}]},{title:"User",key:"/user",icon:Object(r.jsx)(F.a,{})},{title:"Role",key:"/role",icon:Object(r.jsx)(A.a,{})},{title:"Chart",key:"/charts",icon:Object(r.jsx)(D.a,{}),children:[{title:"Bar Chart",key:"/bar",icon:Object(r.jsx)(V.a,{})},{title:"Line Chart",key:"/line",icon:Object(r.jsx)(L.a,{})},{title:"Pie Chart",key:"/Pie",icon:Object(r.jsx)(T.a,{})}]}],q=P.a.SubMenu,z=function(e){var t=e.path;t.indexOf("/product")>=0&&(t="/product");var a="/",n=function e(n){return n.map((function(n){if(function(e){var t=e.key,a=k.user.role.menus;return!!("admin"===k.user.username||e.isPublic||a.indexOf(t)>=0)||!!e.children&&!!e.children.find((function(e){return a.indexOf(e.key)>=0}))}(n))return n.children?(n.children.find((function(e){return e.key===t}))&&(a=n.key),Object(r.jsx)(q,{icon:n.icon,title:n.title,children:e(n.children)},n.key)):Object(r.jsx)(P.a.Item,{icon:n.icon,children:Object(r.jsx)(l.b,{to:n.key,children:n.title})},n.key)}))}(R);return Object(r.jsxs)("div",{className:"leftNav",children:[Object(r.jsxs)(l.b,{to:"/home",className:"leftNav-header",children:[Object(r.jsx)("img",{src:h,alt:"logo"}),Object(r.jsx)("h1",{children:"Management System"})]}),Object(r.jsx)("div",{style:{width:200},children:Object(r.jsx)(P.a,{selectedKeys:[t],defaultOpenKeys:[a],mode:"inline",theme:"dark",children:n})})]})},U=a(43),B=(a(467),a(584)),K=(a(468),function(e){var t=e.text,a=e.click;return Object(r.jsx)("button",{className:"link-button",onClick:a,children:t})}),M=function(e){var t;return e.indexOf("/product")>=0&&(e="/product"),R.forEach((function(a){if(a.key===e)t=a.title;else if(a.children){var n=a.children.find((function(t){return t.key===e}));n&&(t=n.title)}})),t},J=B.a.confirm;function H(){J({title:"Are you Sure to sign out?",onOk:function(){console.log("OK"),I.removeUser(),k.user={},clearInterval(n),window.location.reload()}})}var W=function(e){var t=e.user,a=e.path,s=Object(c.useState)((new Date).toLocaleString()),i=Object(U.a)(s,2),o=i[0],l=i[1];return n=setInterval((function(){var e=(new Date).toLocaleString();l(e)}),1e3),Object(r.jsxs)("div",{className:"header",children:[Object(r.jsxs)("div",{className:"headerTop",children:[Object(r.jsxs)("span",{children:["Welcome, ",t]}),Object(r.jsx)(K,{click:H,text:"Sign out"})]}),Object(r.jsxs)("div",{className:"headerBottom",children:[Object(r.jsx)("div",{className:"headerBottomLeft",children:M(a)}),Object(r.jsx)("div",{className:"headerBottomRight",children:o})]})]})},$=a(185),G=a(592),Q=a(579),X=a(578),Y=a(602),Z=a(169),ee=Z.a.Option,te=function(e){var t=e.visible,a=e.onCreate,n=e.onCancel,s=e.name,i=e.category,o=O.a.useForm(),l=Object(U.a)(o,1)[0];Object(c.useEffect)((function(){l.setFieldsValue({category:s})}),[l,s]);var u=function(){l.resetFields()};return Object(r.jsx)(B.a,{visible:t,title:"Create a new collection",okText:"Create",cancelText:"Cancel",onCancel:function(){u(),n()},getContainer:!1,destroyOnClose:!1,onOk:function(){l.validateFields().then((function(e){l.resetFields(),a(e)})).catch((function(e){f.b.error("Validate Failed:",e)}))},children:Object(r.jsxs)(O.a,{form:l,layout:"vertical",name:"form_in_modal",children:[Object(r.jsx)(O.a.Item,{name:"category",label:"Category",rules:[{required:!0}],children:Object(r.jsxs)(Z.a,{children:[Object(r.jsx)(ee,{value:"0",children:"First class category"}),i.map((function(e){return Object(r.jsx)(ee,{value:e.name,children:e.name},e._id)}))]})}),Object(r.jsx)(O.a.Item,{name:"name",label:"Name",rules:[{required:!0}],children:Object(r.jsx)(p.a,{placeholder:"Please enter category name"})}),Object(r.jsx)(O.a.Item,{children:Object(r.jsx)(x.a,{htmlType:"button",onClick:u,children:"Reset"})})]})})},ae=(a(483),function(e){Object(b.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).formRef=s.a.createRef(),n.getDetail=function(e,t){v(e).then((function(a){var c=a.data.data;"0"===e?n.setState({categories:c,parentName:"First class classification",rank:"0"}):n.setState({subCategories:c,parentName:Object(r.jsxs)("div",{children:[Object(r.jsx)(K,{click:function(){n.setState({rank:"0",parentName:"First class classification"})},text:"First class classification"})," ",t," "]}),rank:t})})).catch((function(e){return f.b.error("Error: "+e)}))},n.createCategory=function(){n.setState({createVisible:!0})},n.updateCategory=function(e){n.catName=e,n.formRef.current&&n.formRef.current.setFieldsValue({name:e}),n.setState({updateVisible:!0})},n.delCategory=function(e,t){var a=B.a.confirm,r=Object($.a)(n);a({title:"Are you Sure to delete all categories related to "+t+"?",onOk:function(){var t;(t=e,y.a.delete("/manage/category/delete",{data:{categoryId:t}})).then((function(e){0===e.data.status?(f.b.success(e.data.data.deletedCount+" categories have been deleted"),r.getDetail("0","")):f.b.error(e.data.msg)})).catch((function(e){return f.b.error("Error: "+e)}))}})},n.handleCancel=function(){n.setState({createVisible:!1,updateVisible:!1})},n.handleSubmit=function(e){var t;t="0"===e.category?"0":n.state.categories.find((function(t){return t.name===e.category}))._id,function(e){return y.a.post("/manage/category/add",e)}({name:e.name,parentId:t}).then((function(e){0===e.data.status?(f.b.success("Success Added!"),n.getDetail("0","")):f.b.error(e.data.msg)})).catch((function(e){return f.b.error("Error: "+e)})),n.handleCancel()},n.handleEdit=function(){n.formRef.current.validateFields().then((function(e){var t;n.formRef.current.resetFields(),t="0"===n.state.rank?n.state.categories.find((function(e){return e.name===n.catName}))._id:n.state.subCategories.find((function(e){return e.name===n.catName}))._id;var a={categoryName:e.name,categoryId:t};console.log(a),function(e){return y.a.post("/manage/category/update",e)}(a).then((function(e){console.log(e.data),0===e.data.status?(f.b.success("Success Changed!"),n.getDetail("0","")):f.b.error(e.data.msg)})).catch((function(e){return f.b.error("Error: "+e)}))})).catch((function(e){f.b.error("Validate Failed:",e)})),n.handleCancel()},n.columns=[{title:"Category Name",dataIndex:"name",key:"name"},{title:"Action",key:"action",width:300,render:function(e){return Object(r.jsxs)(G.b,{size:"middle",children:[Object(r.jsx)(K,{click:function(){n.updateCategory(e.name)},text:"Edit"}),"0"===n.state.rank?Object(r.jsx)(K,{click:function(){return n.getDetail(e._id,e.name)},text:"Details"}):null]})}}],n.state={categories:[],subCategories:[],parentName:"First class classification",rank:"0",createVisible:!1,updateVisible:!1},n}return Object(j.a)(a,[{key:"componentDidMount",value:function(){this.getDetail("0","")}},{key:"render",value:function(){return Object(r.jsxs)("div",{className:"category",children:[Object(r.jsx)(Q.a,{title:this.state.parentName,extra:Object(r.jsx)(x.a,{onClick:this.createCategory,type:"primary",icon:Object(r.jsx)(Y.a,{}),children:"Add category"}),children:Object(r.jsx)(X.a,{bordered:!0,rowKey:"_id",columns:this.columns,dataSource:"0"===this.state.rank?this.state.categories:this.state.subCategories})}),Object(r.jsx)(te,{visible:this.state.createVisible,onCreate:this.handleSubmit,onCancel:this.handleCancel,category:this.state.categories,name:this.state.rank}),Object(r.jsx)(B.a,{title:"Change category name",visible:this.state.updateVisible,onOk:this.handleEdit,onCancel:this.handleCancel,children:Object(r.jsx)(O.a,{ref:this.formRef,initialValues:{name:this.catName},children:Object(r.jsx)(O.a.Item,{name:"name",label:"Name",rules:[{required:!0}],children:Object(r.jsx)(p.a,{})})})})]})}}]),a}(s.a.Component)),ne=a(582),re=a(590),ce=a(588),se=function(){return Object(r.jsx)(ne.a,{theme:re.a.material,children:Object(r.jsx)(ce.a,{style:{data:{fill:"cornflowerblue"}},alignment:"start",data:[{x:1,y:2},{x:2,y:3},{x:3,y:5},{x:4,y:4},{x:5,y:7}]})})},ie=a(587),oe=function(){return Object(r.jsx)(ne.a,{theme:re.a.material,children:Object(r.jsx)(ie.a,{style:{data:{stroke:"cornflowerblue"},parent:{border:"1px solid #ccc"}},data:[{x:1,y:2},{x:2,y:3},{x:3,y:5},{x:4,y:4},{x:5,y:7}]})})},le=a(591),ue=function(){return Object(r.jsx)(le.a,{data:[{x:1,y:2},{x:2,y:3},{x:3,y:5},{x:4,y:4},{x:5,y:7}]})},de=a(593),je=a(604),be=function(e){var t=Object(c.useState)(""),a=Object(U.a)(t,2),n=a[0],s=a[1],i=Object(c.useState)(""),o=Object(U.a)(i,2),l=o[0],u=o[1],d=e.location.state;console.log(d);return Object(c.useEffect)((function(){var e,t;e=d.categoryId,t=d.pCategoryId,C(e).then((function(e){if(0===e.data.status){var t=e.data.data.name;s(t)}else f.b.error(e.data.msg)})).catch((function(e){return f.b.error(e)})),"0"!==t&&C(t).then((function(e){if(0===e.data.status){var t=e.data.data.name;u(t)}else f.b.error(e.data.msg)})).catch((function(e){return f.b.error(e)}))}),[d.categoryId,d.pCategoryId]),Object(r.jsx)(Q.a,{title:Object(r.jsxs)("span",{children:[Object(r.jsx)(je.a,{onClick:function(){return window.history.back()},style:{color:"cornflowerblue"}}),"Back"]}),children:Object(r.jsxs)(de.b,{children:[Object(r.jsxs)(de.b.Item,{children:[Object(r.jsx)("span",{className:"left",children:"Product Name:"}),d.name]}),Object(r.jsxs)(de.b.Item,{children:[Object(r.jsx)("span",{className:"left",children:"Product Description:"}),d.desc]}),Object(r.jsxs)(de.b.Item,{children:[Object(r.jsx)("span",{className:"left",children:"Price:"}),d.price," Euro"]}),Object(r.jsxs)(de.b.Item,{children:[Object(r.jsx)("span",{className:"left",children:"Product Category:"}),""===l?n:n+" -> "+l]})]})})},me=a(219),he=p.a.Search,fe=function(e){Object(b.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).getProducts=function(e,t){var a,r;(a=e,r=t,y.a.get("/manage/product/list",{params:{pageNum:a,pageSize:r}})).then((function(e){if(0===e.data.status){var t=e.data.data.list,a=e.data.data.total;n.setState({productList:t,totalProduct:a})}else f.b.error(e.data.msg)})).catch((function(e){return f.b.error("Error: "+e)}))},n.onChange=function(e){n.setState({pageNow:e}),""===n.state.searchInput?n.getProducts(e,7):n.searchProducts(n.state.searchInput,e)},n.updateStatus=function(e,t){(function(e){var t=e.productId,a=e.status;return y.a.post("/manage/product/updateStatus",{productId:t,status:a})})({productId:t,status:1===e?2:1}).then((function(e){0===e.data.status?""===n.state.searchInput?n.getProducts(n.state.pageNow,7):n.searchProducts(n.state.searchInput,n.state.pageNow):f.b.error(e.data.msg)})).catch((function(e){return f.b.error(e)}))},n.searchProducts=function(e,t){var a,r,c;(a=t,r=7,c=e,y.a.get("/manage/product/search",{params:{pageNum:a,pageSize:r,productName:c}})).then((function(e){if(0===e.data.status){var t=e.data.data.list,a=e.data.data.total;n.setState({productList:t,totalProduct:a})}else f.b.error(e.data.msg)})).catch((function(e){return f.b.error(e)}))},n.onSearch=function(e){n.setState({pageNow:1,searchInput:e}),n.searchProducts(e,1)},n.showDetail=function(e){n.props.history.push("/product/detail",e)},n.columns=[{title:"Product Name",dataIndex:"name",key:"name"},{title:"Description",dataIndex:"desc",key:"description",width:600},{title:"Price(Euro)",dataIndex:"price",key:"price"},{title:"Status",dataIndex:"status",key:"status",render:function(e,t){return Object(r.jsxs)(G.b,{size:"middle",children:[Object(r.jsx)("span",{children:1===e?"on sale":"sold out"}),Object(r.jsx)(K,{click:function(){n.updateStatus(e,t._id)},text:1===e?"sold out":"on sale"})]})}},{title:"Action",key:"action",width:120,render:function(e){return Object(r.jsxs)(G.b,{size:"middle",children:[Object(r.jsx)(K,{click:function(){return n.props.history.push("/product/addupdate",e)},text:"Edit"}),Object(r.jsx)(K,{click:function(){return n.showDetail(e)},text:"Details"})]})}}],n.state={productList:[],pageNow:1,totalProduct:1,searchInput:""},n}return Object(j.a)(a,[{key:"componentDidMount",value:function(){this.getProducts(this.state.pageNow,7)}},{key:"render",value:function(){var e=this;return Object(r.jsxs)(Q.a,{title:Object(r.jsx)("span",{children:Object(r.jsx)(he,{style:{width:300},placeholder:"item name",allowClear:!0,enterButton:"Search",size:"large",onSearch:this.onSearch})}),extra:Object(r.jsx)(x.a,{onClick:function(){return e.props.history.push("/product/addupdate")},type:"primary",icon:Object(r.jsx)(Y.a,{}),children:"Add product"}),children:[Object(r.jsx)(X.a,{bordered:!0,rowKey:"_id",columns:this.columns,pagination:!1,dataSource:this.state.productList}),Object(r.jsx)("br",{}),Object(r.jsx)(me.a,{current:this.state.pageNow,style:{textAlign:"right"},defaultPageSize:7,defaultCurrent:this.state.pageNow,total:this.state.totalProduct,onChange:this.onChange})]})}}]),a}(s.a.Component),Oe=a(254),pe=a(349),xe=a(585),ge=p.a.TextArea,ye={labelCol:{span:4},wrapperCol:{span:8}},ve=function(e){(function(e){return y.a.post("/manage/product/add",e)})({categoryId:e.category[1]?e.category[1]:e.category[0],pCategoryId:e.category[1]?e.category[0]:"0",name:e.name,price:e.price,desc:e.desc,status:1}).then((function(e){0===e.data.status?f.b.success("Success Added!"):f.b.error(e.data.msg)})).catch((function(e){return f.b.error("Error: "+e)}))},Ce=function(e){var t=O.a.useForm(),a=Object(U.a)(t,1)[0],n=Object(c.useState)([]),s=Object(U.a)(n,2),i=s[0],o=s[1],l=Object(c.useState)([]),u=Object(U.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)(0),m=Object(U.a)(b,2),h=m[0],g=m[1],C=Object(c.useState)([]),k=Object(U.a)(C,2),S=k[0],I=k[1],w=Object(c.useState)({}),N=Object(U.a)(w,2),P=N[0],_=N[1],E=e.location.state;E||(E={name:"",desc:"",price:0,categoryId:"0",pCategoryId:"0"});var F=function(t){(function(e){return y.a.post("/manage/product/update",e)})({categoryId:t.category[1]?t.category[1]:t.category[0],pCategoryId:t.category[1]?t.category[0]:"0",name:t.name,price:t.price,desc:t.desc,_id:e.location.state._id,status:1}).then((function(e){0===e.data.status?f.b.success("Success Changed!"):f.b.error(e.data.msg)})).catch((function(e){return f.b.error("Error: "+e)}))},A=function(e){v(e).then((function(t){var a=t.data.data;"0"===e?(o(a),g(1)):j(a)})).catch((function(e){return f.b.error("Error: "+e)}))};return Object(c.useEffect)((function(){P.loading=!1,P.children=d.map((function(e){return{value:e._id,label:e.name}})),I(Object(pe.a)(S)),console.log(S)}),[d]),Object(c.useEffect)((function(){A("0");var e=i.map((function(e){return{value:e._id,label:e.name,isLeaf:!1}}));"0"!==E.pCategoryId&&(_(e.find((function(e){return e.value===E.pCategoryId}))),A(E.pCategoryId)),I(e)}),[h]),Object(r.jsx)(Q.a,{title:Object(r.jsxs)("span",{children:[Object(r.jsx)(je.a,{onClick:function(){return window.history.back()},style:{color:"cornflowerblue"}}),"Add Product"]}),children:Object(r.jsxs)(O.a,Object(Oe.a)(Object(Oe.a)({},ye),{},{form:a,name:"control-hooks",onFinish:function(t){e.location.state?F(t):ve(t)},children:[Object(r.jsx)(O.a.Item,{name:"name",initialValue:E.name,label:"Product Name",rules:[{required:!0}],children:Object(r.jsx)(p.a,{})}),Object(r.jsx)(O.a.Item,{name:"desc",initialValue:E.desc,label:"Product Description",rules:[{required:!0}],children:Object(r.jsx)(ge,{autoSize:!0})}),Object(r.jsx)(O.a.Item,{name:"price",initialValue:E.price,label:"Product Price",rules:[{required:!0},function(e){var t=e.getFieldValue;return{validator:function(e,a){return!a||t("price")>=0?Promise.resolve():Promise.reject("The price must be valid!")}}}],children:Object(r.jsx)(p.a,{type:"number",suffix:"Euro"})}),Object(r.jsx)(O.a.Item,{name:"category",label:"Product Category",rules:[{required:!0}],initialValue:"0"===E.categoryId?[]:"0"===E.pCategoryId?[E.categoryId]:[E.pCategoryId,E.categoryId],children:Object(r.jsx)(xe.a,{options:S,loadData:function(e){var t=e[e.length-1];_(t),t.loading=!0,A(t.value)},onChange:function(e){},placeholder:"Please select",changeOnSelect:!0})}),Object(r.jsx)(O.a.Item,{children:Object(r.jsx)(x.a,{type:"primary",htmlType:"submit",children:"Submit"})})]}))})},ke=(a(555),function(){return Object(r.jsxs)(u.d,{children:[Object(r.jsx)(u.b,{path:"/product/detail",component:be}),Object(r.jsx)(u.b,{path:"/product/addupdate",component:Ce}),Object(r.jsx)(u.b,{path:"/product",component:fe,exact:!0}),Object(r.jsx)(u.a,{to:"/product"})]})}),Se=a(586),Ie=function(e){var t=e.visible,a=e.onCreate,n=e.onCancel,c=O.a.useForm(),s=Object(U.a)(c,1)[0];return Object(r.jsx)(B.a,{visible:t,title:"Create new role",okText:"Create",cancelText:"Cancel",onCancel:n,getContainer:!1,destroyOnClose:!1,onOk:function(){s.validateFields().then((function(e){s.resetFields(),a(e)})).catch((function(e){f.b.error("Validate Failed:",e)}))},children:Object(r.jsx)(O.a,{form:s,layout:"vertical",name:"form_in_modal",children:Object(r.jsx)(O.a.Item,{name:"name",label:"Name",rules:[{required:!0}],children:Object(r.jsx)(p.a,{placeholder:"Please enter role name"})})})})},we=[{title:"Platform Privilege",key:"0-0",children:R}],Ne=function(){var e=Object(c.useState)([]),t=Object(U.a)(e,2),a=t[0],n=t[1],s=Object(c.useState)({}),i=Object(U.a)(s,2),o=i[0],l=i[1],u=Object(c.useState)(0),d=Object(U.a)(u,2),j=d[0],b=d[1],m=Object(c.useState)(!1),h=Object(U.a)(m,2),O=h[0],g=h[1],v=Object(c.useState)(!1),C=Object(U.a)(v,2),S=C[0],w=C[1],N=Object(c.useState)([]),P=Object(U.a)(N,2),_=P[0],E=P[1],F=function(){y.a.get("/manage/role/list").then((function(e){if(0===e.data.status){var t=e.data.data;n(t),b(1)}else f.b.error(e.data.msg)})).catch((function(e){return f.b.error(e)}))},A=function(){g(!1),E(o.menus),w(!1)},D=function(e){console.log(e),function(e){return y.a.post("/manage/role/update",e)}(o).then((function(e){0===e.data.status?(f.b.success(o.name+" updated"),w(!1),b(0),k.user.role_id===o._id&&(k.user={},I.removeUser(),window.location.reload(),f.b.info("role permissions have been changed, please login again!"))):f.b.error(e.data.msg)})).catch((function(e){return f.b.error(e)}))},V=[{title:"Role Name",dataIndex:"name",key:"name"},{title:"Create Time",dataIndex:"create_time",key:"ctime",render:function(e){return new Date(e).toLocaleString()}},{title:"Authorization Time",dataIndex:"auth_time",key:"atime",render:function(e){if(e)return new Date(e).toLocaleString()}},{title:"Authorizer",dataIndex:"auth_name",key:"aname"}];return Object(c.useEffect)((function(){F()}),[j]),Object(c.useEffect)((function(){E(o.menus)}),[o]),Object(r.jsxs)(Q.a,{title:Object(r.jsxs)("span",{children:[Object(r.jsx)(x.a,{onClick:function(){g(!0)},type:"primary",children:"New Role"})," \xa0",Object(r.jsx)(x.a,{onClick:function(){w(!0)},type:"primary",disabled:!o._id,children:"Set role permissions"})]}),children:[Object(r.jsx)(X.a,{bordered:!0,rowSelection:{type:"radio",selectedRowKeys:[o._id],onSelect:function(e){l(e)}},rowKey:"_id",onRow:function(e){return{onClick:function(t){l(e)}}},columns:V,dataSource:a}),Object(r.jsx)(Ie,{visible:O,onCreate:function(e){var t;(t=e.name,y.a.post("/manage/role/add",{roleName:t})).then((function(t){0===t.data.status?(f.b.success(e.name+" Added"),g(!1),b(0)):f.b.error(t.data.msg)})).catch((function(e){return f.b.error(e)}))},onCancel:A}),Object(r.jsxs)(B.a,{visible:S,title:"Edit permissions",okText:"Submit",cancelText:"Cancel",onCancel:A,getContainer:!1,destroyOnClose:!0,onOk:function(){var e=o;e.menus=_,e.auth_name=k.user.username,D(e),w(!1)},children:["Role Name: ",Object(r.jsx)(p.a,{value:o.name,disabled:!0}),Object(r.jsx)(Se.a,{checkable:!0,defaultExpandAll:!0,onCheck:function(e){console.log("onCheck",e),E(e)},checkedKeys:_,treeData:we})]})]})},Pe=Z.a.Option,_e={required:"${label} is required!",types:{email:"${label} is not a valid email!"}},Ee=function(e){var t=e.visible,a=e.onCreate,n=e.onCancel,s=e.user,i=e.title,o=e.roleList,l=O.a.useForm(),u=Object(U.a)(l,1)[0];Object(c.useEffect)((function(){"Add a user"!==i&&u.setFieldsValue({name:s.username,number:s.number,email:s.email,category:s.role_id,password:s.password})}),[u,s]);return Object(r.jsx)(B.a,{visible:t,title:i,okText:"Create",cancelText:"Cancel",onCancel:n,getContainer:!1,destroyOnClose:!1,onOk:function(){u.validateFields().then((function(e){u.resetFields();var t={};"Add a user"!==i&&(t=s),t.username=e.name,t.email=e.email,t.phone=e.number,t.role_id=e.category,t.password=e.password,a(t)})).catch((function(e){f.b.error("Validate Failed:",e)}))},children:Object(r.jsxs)(O.a,{form:u,layout:"vertical",validateMessages:_e,name:"form_in_modal",children:[Object(r.jsx)(O.a.Item,{name:"name",label:"Name",rules:[{required:!0}],children:Object(r.jsx)(p.a,{placeholder:"Please enter user name"})}),Object(r.jsx)(O.a.Item,{hidden:"Add a user"!==i,name:"password",label:"Password",rules:[{required:!0}],children:Object(r.jsx)(p.a.Password,{placeholder:"Please enter password"})}),Object(r.jsx)(O.a.Item,{name:"number",label:"Mobile number",children:Object(r.jsx)(p.a,{placeholder:"Please enter mobile number"})}),Object(r.jsx)(O.a.Item,{name:"email",label:"Email",rules:[{type:"email"}],children:Object(r.jsx)(p.a,{placeholder:"Please enter email"})}),Object(r.jsx)(O.a.Item,{name:"category",label:"Category",rules:[{required:!0}],children:Object(r.jsx)(Z.a,{placeholder:"Please select role",children:o.map((function(e){return Object(r.jsx)(Pe,{value:e._id,children:e.name},e._id)}))})})]})})},Fe=function(){var e=Object(c.useState)([]),t=Object(U.a)(e,2),a=t[0],n=t[1],s=Object(c.useState)([]),i=Object(U.a)(s,2),o=i[0],l=i[1],u=Object(c.useState)(0),d=Object(U.a)(u,2),j=d[0],b=d[1],m=Object(c.useState)(!1),h=Object(U.a)(m,2),O=h[0],p=h[1],g=Object(c.useState)({}),v=Object(U.a)(g,2),C=v[0],k=v[1],S=Object(c.useState)(""),I=Object(U.a)(S,2),w=I[0],N=I[1],P=function(){y.a.get("/manage/user/list").then((function(e){if(0===e.data.status){console.log(e.data.data);var t=e.data.data.users,a=e.data.data.roles;n(t),l(a),b(1)}else f.b.error(e.data.msg)})).catch((function(e){return f.b.error(e)}))},_=function(e){(0,B.a.confirm)({title:"Are you Sure to delete "+e.username+"?",onOk:function(){var t;(t=e._id,y.a.delete("/manage/user/delete",{data:{userId:t}})).then((function(t){0===t.data.status?(f.b.success(e.username+" has been deleted"),b(0)):f.b.error(t.data.msg)})).catch((function(e){return f.b.error("Error: "+e)}))}})},E=[{title:"Name",dataIndex:"username",key:"username"},{title:"Email",dataIndex:"email",key:"email"},{title:"Phone number",dataIndex:"phone",key:"phone"},{title:"Create Time",dataIndex:"create_time",key:"create_time",render:function(e){return new Date(e).toLocaleString()}},{title:"Role",dataIndex:"role_id",key:"role_id",render:function(e){if(e&&o.length>0)return o.find((function(t){return t._id===e})).name}},{title:"Action",key:"action",width:300,render:function(e){return Object(r.jsxs)(G.b,{size:"middle",children:[Object(r.jsx)(K,{click:function(){return function(e){N("Edit"+e.username),p(!0),k(e)}(e)},text:"Edit"}),Object(r.jsx)(K,{click:function(){_(e)},text:"Delete"})]})}}];return Object(c.useEffect)((function(){P()}),[j]),Object(r.jsxs)(Q.a,{title:Object(r.jsx)("span",{children:Object(r.jsx)(x.a,{onClick:function(){p(!0),N("Add a user")},type:"primary",children:"New User"})}),children:[Object(r.jsx)(X.a,{bordered:!0,rowKey:"_id",columns:E,dataSource:a}),Object(r.jsx)(Ee,{visible:O,onCreate:function(e){"Add a user"===w?function(e){return y.a.post("/manage/user/add",e)}(e).then((function(e){0===e.data.status?(console.log(e.data.data),f.b.success("success added!"),b(0)):f.b.error(e.data.msg)})).catch((function(e){return f.b.error(e)})):function(e){return y.a.post("/manage/user/update",e)}(e).then((function(e){0===e.data.status?(console.log(e.data.data),f.b.success("success added!"),b(0)):f.b.error(e.data.msg)})).catch((function(e){return f.b.error(e)})),console.log(e),p(!1)},onCancel:function(){return p(!1)},user:C,title:w,roleList:o})]})},Ae=(a(568),function(){return Object(r.jsx)("div",{className:"home",children:Object(r.jsx)("h1",{className:"home-word",children:"Welcome to Products Background Management System!"})})}),De=N.a.Footer,Ve=N.a.Sider,Le=N.a.Content,Te=function(e){Object(b.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).user=k.user,e}return Object(j.a)(a,[{key:"render",value:function(){return this.user&&this.user._id?Object(r.jsxs)(N.a,{style:{height:"100%"},children:[Object(r.jsx)(Ve,{children:Object(r.jsx)(z,{path:this.props.location.pathname})}),Object(r.jsxs)(N.a,{children:[Object(r.jsx)(W,{user:this.user.username,path:this.props.location.pathname,children:"Header"}),Object(r.jsx)(Le,{style:{margin:20,backgroundColor:"white"},children:Object(r.jsxs)(u.d,{children:[Object(r.jsx)(u.b,{path:"/home",component:Ae}),Object(r.jsx)(u.b,{path:"/category",component:ae}),Object(r.jsx)(u.b,{path:"/product",component:ke}),Object(r.jsx)(u.b,{path:"/user",component:Fe}),Object(r.jsx)(u.b,{path:"/role",component:Ne}),Object(r.jsx)(u.b,{path:"/pie",component:ue}),Object(r.jsx)(u.b,{path:"/line",component:oe}),Object(r.jsx)(u.b,{path:"/bar",component:se}),Object(r.jsx)(u.a,{to:"/home"})]})}),Object(r.jsx)(De,{style:{textAlign:"center",color:"#cccccc"},children:"Use Chrome to get better experience!"})]})]}):Object(r.jsx)(u.a,{to:"/login"})}}]),a}(s.a.Component),Re=function(){return Object(r.jsx)(l.a,{children:Object(r.jsxs)(u.d,{children:[Object(r.jsx)(u.b,{path:"/login",component:w}),Object(r.jsx)(u.b,{path:"/",component:Te})]})})},qe=I.getUser();k.user=qe,o.a.render(Object(r.jsx)(Re,{}),document.getElementById("root"))}},[[569,1,2]]]);
//# sourceMappingURL=main.02478f46.chunk.js.map